<%- include('partials/header', { title: 'Commande confirmée - Mansa', user: user }) %>

<section class="py-12 min-h-screen bg-gray-100">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <!-- Success Message -->
            <div class="bg-white rounded-lg shadow-md p-8 text-center mb-8">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-check text-3xl text-green-600"></i>
                </div>
                
                <h1 class="text-3xl font-bold text-bogolan mb-4">Commande confirmée !</h1>
                <p class="text-lg text-gray-600 mb-2">
                    Merci <%= user ? user.prenom : 'pour votre commande' %> ! Votre commande a été enregistrée avec succès.
                </p>
                <p class="text-gray-600">
                    Vous recevrez un email de confirmation sous peu.
                </p>
                
                <div class="bg-bogolan-50 border border-bogolan-200 rounded-lg p-4 mt-6 mb-6">
                    <p class="text-bogolan-800">
                        <strong>Numéro de commande :</strong> 
                        <span class="font-mono text-lg">#<%= numeroCommande %></span>
                    </p>
                </div>
            </div>

            <!-- Order Details -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-bold text-bogolan mb-6">Détails de votre commande</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Delivery Address -->
                    <div>
                        <h3 class="font-semibold mb-3">Adresse de livraison</h3>
                        <div class="text-gray-600 space-y-1">
                            <% if (adresseLivraison) { %>
                                <p><%= adresseLivraison.prenom %> <%= adresseLivraison.nom %></p>
                                <p><%= adresseLivraison.adresse_ligne1 %></p>
                                <% if (adresseLivraison.adresse_ligne2) { %>
                                    <p><%= adresseLivraison.adresse_ligne2 %></p>
                                <% } %>
                                <p><%= adresseLivraison.code_postal %> <%= adresseLivraison.ville %></p>
                                <p><%= adresseLivraison.pays %></p>
                                <% if (adresseLivraison.telephone) { %>
                                    <p><i class="fas fa-phone mr-2"></i><%= adresseLivraison.telephone %></p>
                                <% } %>
                            <% } %>
                        </div>
                    </div>

                    <!-- Payment Info -->
                    <div>
                        <h3 class="font-semibold mb-3">Informations de paiement</h3>
                        <div class="text-gray-600 space-y-2">
                            <p>
                                <i class="fas fa-credit-card mr-2"></i>
                                Mode de paiement : 
                                <span class="capitalize"><%= modePaiement || 'Carte bancaire' %></span>
                            </p>
                            <p>
                                <i class="fas fa-check-circle mr-2 text-green-500"></i>
                                Statut : <span class="text-green-600 font-semibold">Confirmée</span>
                            </p>
                            <div class="bg-blue-50 border border-blue-200 rounded p-3 mt-3">
                                <p class="text-sm text-blue-800">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    Mode démonstration : Aucun paiement réel n'a été effectué
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- What's Next -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-bold text-bogolan mb-6">Et maintenant ?</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-envelope text-2xl text-blue-600"></i>
                        </div>
                        <h3 class="font-semibold mb-2">Confirmation par email</h3>
                        <p class="text-sm text-gray-600">
                            Vous recevrez un email de confirmation avec tous les détails de votre commande.
                        </p>
                    </div>
                    
                    <div class="text-center">
                        <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-box text-2xl text-yellow-600"></i>
                        </div>
                        <h3 class="font-semibold mb-2">Préparation</h3>
                        <p class="text-sm text-gray-600">
                            Votre commande sera préparée avec soin dans les 24-48h.
                        </p>
                    </div>
                    
                    <div class="text-center">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-truck text-2xl text-green-600"></i>
                        </div>
                        <h3 class="font-semibold mb-2">Expédition</h3>
                        <p class="text-sm text-gray-600">
                            Livraison sous 3-5 jours ouvrés. Vous recevrez un numéro de suivi.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/mes-commandes" class="bg-bogolan text-white px-6 py-3 rounded-lg font-semibold hover:bg-bogolan-light transition-colors text-center">
                    <i class="fas fa-list mr-2"></i>
                    Voir mes commandes
                </a>
                
                <a href="/boutique" class="bg-terre text-white px-6 py-3 rounded-lg font-semibold hover:bg-terre-light transition-colors text-center">
                    <i class="fas fa-shopping-bag mr-2"></i>
                    Continuer mes achats
                </a>
                
                <a href="/" class="bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-colors text-center">
                    <i class="fas fa-home mr-2"></i>
                    Retour à l'accueil
                </a>
            </div>

            <!-- Customer Service -->
            <div class="bg-bogolan-50 border border-bogolan-200 rounded-lg p-6 mt-8 text-center">
                <h3 class="font-semibold text-bogolan-800 mb-2">Besoin d'aide ?</h3>
                <p class="text-bogolan-700 mb-4">
                    Notre équipe est à votre disposition pour toute question concernant votre commande.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="mailto:contact@mansa.com" class="text-bogolan-700 hover:text-bogolan-900 font-medium">
                        <i class="fas fa-envelope mr-2"></i>
                        contact@mansa.com
                    </a>
                    <a href="tel:+33123456789" class="text-bogolan-700 hover:text-bogolan-900 font-medium">
                        <i class="fas fa-phone mr-2"></i>
                        01 23 45 67 89
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// Animation d'entrée
document.addEventListener('DOMContentLoaded', function() {
    // Ajouter une animation à la coche de succès
    const successIcon = document.querySelector('.fa-check');
    if (successIcon) {
        successIcon.style.transform = 'scale(0)';
        setTimeout(() => {
            successIcon.style.transition = 'transform 0.5s ease-out';
            successIcon.style.transform = 'scale(1)';
        }, 300);
    }
    
    // Mettre à jour le compteur du panier (il devrait être à 0 maintenant)
    updateCartCount();
});

// Update cart count
async function updateCartCount() {
    try {
        const response = await fetch('/api/panier/count');
        const data = await response.json();
        if (data.success) {
            document.getElementById('cart-count').textContent = data.count;
        }
    } catch (error) {
        console.error('Erreur mise à jour compteur panier:', error);
    }
}
</script>

<%- include('partials/footer') %>
